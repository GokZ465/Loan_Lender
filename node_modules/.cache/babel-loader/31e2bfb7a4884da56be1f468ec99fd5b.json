{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useReducer, useEffect, useState } from \"react\";\nimport { fireStore, timestamp } from \"../fireBaeDateBae/config\";\nlet initialState = {\n  document: null,\n  isPending: false,\n  error: null,\n  success: null\n};\n\nconst firestoreReducer = (state, action) => {\n  switch (action.type) {\n    case \"IS_PENDING\":\n      return {\n        success: false,\n        isPending: true,\n        error: null,\n        document: null\n      };\n\n    case \"ERROR\":\n      return {\n        success: false,\n        isPending: false,\n        error: action.payload,\n        document: null\n      };\n\n    case \"ADDED_DOCUMENT\":\n      return {\n        success: true,\n        isPending: false,\n        error: null,\n        document: action.payload\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport const useFirestore = collection => {\n  _s();\n\n  const [response, dispatch] = useReducer(firestoreReducer, initialState);\n  const [isCancelled, setIsCancelled] = useState(false);\n  const ref = fireStore.collection(collection);\n\n  const dispatchIfNotCancelled = action => {\n    if (!isCancelled) {\n      dispatch(action);\n    }\n  };\n\n  const addDocument = async doc => {\n    dispatch({\n      type: \"IS_PENDING\"\n    });\n\n    try {\n      const createdAt = timestamp.fromDate(new Date());\n      const addedDocument = await ref.add({ ...doc,\n        createdAt\n      });\n      console.log(\"in addDoc try\");\n      dispatchIfNotCancelled({\n        type: \"ADDED_DOCUMENT\",\n        payload: addedDocument\n      });\n    } catch (err) {\n      console.log();\n      dispatchIfNotCancelled({\n        type: \"ERROR\",\n        payload: err.message\n      });\n    }\n  };\n\n  const deleteDocument = async doc => {};\n\n  useEffect(() => {\n    return () => setIsCancelled(true);\n  }, []);\n  return {\n    addDocument,\n    deleteDocument,\n    response\n  };\n};\n\n_s(useFirestore, \"9EVgiqay/R51d/Adc6OMNoHTwUQ=\");","map":{"version":3,"names":["useReducer","useEffect","useState","fireStore","timestamp","initialState","document","isPending","error","success","firestoreReducer","state","action","type","payload","useFirestore","collection","response","dispatch","isCancelled","setIsCancelled","ref","dispatchIfNotCancelled","addDocument","doc","createdAt","fromDate","Date","addedDocument","add","console","log","err","message","deleteDocument"],"sources":["E:/movie/loanLender/loanlender/src/hooks/useFirestore.js"],"sourcesContent":["import { useReducer, useEffect, useState } from \"react\";\r\nimport { fireStore, timestamp } from \"../fireBaeDateBae/config\";\r\n\r\nlet initialState = {\r\n  document: null,\r\n  isPending: false,\r\n  error: null,\r\n  success: null,\r\n};\r\n\r\nconst firestoreReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"IS_PENDING\":\r\n      return { success: false, isPending: true, error: null, document: null };\r\n    case \"ERROR\":\r\n      return {\r\n        success: false,\r\n        isPending: false,\r\n        error: action.payload,\r\n        document: null,\r\n      };\r\n    case \"ADDED_DOCUMENT\":\r\n      return {\r\n        success: true,\r\n        isPending: false,\r\n        error: null,\r\n        document: action.payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport const useFirestore = (collection) => {\r\n  const [response, dispatch] = useReducer(firestoreReducer, initialState);\r\n  const [isCancelled, setIsCancelled] = useState(false);\r\n\r\n  const ref = fireStore.collection(collection);\r\n\r\n  const dispatchIfNotCancelled = (action) => {\r\n    if (!isCancelled) {\r\n      dispatch(action);\r\n    }\r\n  };\r\n\r\n  const addDocument = async (doc) => {\r\n    dispatch({ type: \"IS_PENDING\" });\r\n\r\n    try {\r\n      const createdAt = timestamp.fromDate(new Date());\r\n      const addedDocument = await ref.add({ ...doc, createdAt });\r\n      console.log(\"in addDoc try\");\r\n      dispatchIfNotCancelled({\r\n        type: \"ADDED_DOCUMENT\",\r\n        payload: addedDocument,\r\n      });\r\n    } catch (err) {\r\n      console.log();\r\n\r\n      dispatchIfNotCancelled({ type: \"ERROR\", payload: err.message });\r\n    }\r\n  };\r\n\r\n  const deleteDocument = async (doc) => {};\r\n\r\n  useEffect(() => {\r\n    return () => setIsCancelled(true);\r\n  }, []);\r\n\r\n  return { addDocument, deleteDocument, response };\r\n};\r\n"],"mappings":";;AAAA,SAASA,UAAT,EAAqBC,SAArB,EAAgCC,QAAhC,QAAgD,OAAhD;AACA,SAASC,SAAT,EAAoBC,SAApB,QAAqC,0BAArC;AAEA,IAAIC,YAAY,GAAG;EACjBC,QAAQ,EAAE,IADO;EAEjBC,SAAS,EAAE,KAFM;EAGjBC,KAAK,EAAE,IAHU;EAIjBC,OAAO,EAAE;AAJQ,CAAnB;;AAOA,MAAMC,gBAAgB,GAAG,CAACC,KAAD,EAAQC,MAAR,KAAmB;EAC1C,QAAQA,MAAM,CAACC,IAAf;IACE,KAAK,YAAL;MACE,OAAO;QAAEJ,OAAO,EAAE,KAAX;QAAkBF,SAAS,EAAE,IAA7B;QAAmCC,KAAK,EAAE,IAA1C;QAAgDF,QAAQ,EAAE;MAA1D,CAAP;;IACF,KAAK,OAAL;MACE,OAAO;QACLG,OAAO,EAAE,KADJ;QAELF,SAAS,EAAE,KAFN;QAGLC,KAAK,EAAEI,MAAM,CAACE,OAHT;QAILR,QAAQ,EAAE;MAJL,CAAP;;IAMF,KAAK,gBAAL;MACE,OAAO;QACLG,OAAO,EAAE,IADJ;QAELF,SAAS,EAAE,KAFN;QAGLC,KAAK,EAAE,IAHF;QAILF,QAAQ,EAAEM,MAAM,CAACE;MAJZ,CAAP;;IAMF;MACE,OAAOH,KAAP;EAlBJ;AAoBD,CArBD;;AAuBA,OAAO,MAAMI,YAAY,GAAIC,UAAD,IAAgB;EAAA;;EAC1C,MAAM,CAACC,QAAD,EAAWC,QAAX,IAAuBlB,UAAU,CAACU,gBAAD,EAAmBL,YAAnB,CAAvC;EACA,MAAM,CAACc,WAAD,EAAcC,cAAd,IAAgClB,QAAQ,CAAC,KAAD,CAA9C;EAEA,MAAMmB,GAAG,GAAGlB,SAAS,CAACa,UAAV,CAAqBA,UAArB,CAAZ;;EAEA,MAAMM,sBAAsB,GAAIV,MAAD,IAAY;IACzC,IAAI,CAACO,WAAL,EAAkB;MAChBD,QAAQ,CAACN,MAAD,CAAR;IACD;EACF,CAJD;;EAMA,MAAMW,WAAW,GAAG,MAAOC,GAAP,IAAe;IACjCN,QAAQ,CAAC;MAAEL,IAAI,EAAE;IAAR,CAAD,CAAR;;IAEA,IAAI;MACF,MAAMY,SAAS,GAAGrB,SAAS,CAACsB,QAAV,CAAmB,IAAIC,IAAJ,EAAnB,CAAlB;MACA,MAAMC,aAAa,GAAG,MAAMP,GAAG,CAACQ,GAAJ,CAAQ,EAAE,GAAGL,GAAL;QAAUC;MAAV,CAAR,CAA5B;MACAK,OAAO,CAACC,GAAR,CAAY,eAAZ;MACAT,sBAAsB,CAAC;QACrBT,IAAI,EAAE,gBADe;QAErBC,OAAO,EAAEc;MAFY,CAAD,CAAtB;IAID,CARD,CAQE,OAAOI,GAAP,EAAY;MACZF,OAAO,CAACC,GAAR;MAEAT,sBAAsB,CAAC;QAAET,IAAI,EAAE,OAAR;QAAiBC,OAAO,EAAEkB,GAAG,CAACC;MAA9B,CAAD,CAAtB;IACD;EACF,CAhBD;;EAkBA,MAAMC,cAAc,GAAG,MAAOV,GAAP,IAAe,CAAE,CAAxC;;EAEAvB,SAAS,CAAC,MAAM;IACd,OAAO,MAAMmB,cAAc,CAAC,IAAD,CAA3B;EACD,CAFQ,EAEN,EAFM,CAAT;EAIA,OAAO;IAAEG,WAAF;IAAeW,cAAf;IAA+BjB;EAA/B,CAAP;AACD,CArCM;;GAAMF,Y"},"metadata":{},"sourceType":"module"}